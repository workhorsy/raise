#!/usr/bin/env python
# -*- coding: UTF-8 -*-

import os
import lib_raise_c as C
import lib_raise_linker as Linker
import lib_raise_fs as FS
import lib_raise_libraries as Libraries
import lib_raise_os as OS
import lib_raise_process as Process

def clean():
	"""Removes any files and directories generated when building."""
	FS.remove_binaries('raise_example')
	FS.remove_binaries('main')

def _configure():
	cc = C.get_default_compiler()
	cc.debug = True
	cc.optimize = True
	cc.warnings_all = True
	cc.warnings_as_errors = True
	C.save_compiler(cc)

def test():
	"""Builds the program, and runs it."""
	# Setup
	OS.require_not_root()
	clean()
	_configure()

	# Build the program
	C.build_program('raise_example.exe', ['main.c'])

	# Run the program
	C.run_say('./raise_example.exe')

def _remove():
	C.uninstall_program('raise_example.exe')

def remove():
	"""Uninstalls the program."""
	# Setup
	OS.require_root()
	clean()
	_configure()

	# Remove the old files
	_remove()

def install():
	"""Installs the program."""
	# Setup
	OS.require_root()
	clean()
	_configure()

	# Build as a normal user
	def actual_build():
		C.build_program('raise_example.exe', ['main.c'])
	OS.do_as_normal_user(actual_build)

	# Remove old install
	_remove()

	# Install
	C.install_program('raise_example.exe')






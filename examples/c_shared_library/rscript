#!/usr/bin/env python
# -*- coding: UTF-8 -*-


def clean():
	"""Removes any files and directories generated when building."""
	rmfile_f('raise_example')
	rmfile_f('libexample.o')
	rmfile_f('libexample.so')

def _configure():
	os.environ['CC'] = 'gcc'
	os.environ['CFLAGS'] = '-g -Wall -Werror'
	os.environ['LD_LIBRARY_PATH'] = os.getcwd()

def test():
	"""Builds the program, and runs it."""
	require_not_root()
	clean()
	_configure()

	c_build_object('libexample.o', ['libexample.c'])
	c_build_shared_library('libexample.so', ['libexample.o'])

	c_build_program('raise_example', ['main.c'], ['${LD_LIBRARY_PATH}/libexample.so'])

	run_say('./raise_example')

def remove():
	"""Uninstalls the program."""
	require_root()
	clean()

	rmfile_f('/usr/bin/raise_example')
	rmfile_f('/usr/lib/libexample.so')

def install():
	"""Installs the program."""
	require_root()
	clean()
	remove()

	_configure()
	c_build_object('libexample.o', ['libexample.c'])
	c_build_shared_library('libexample.so', ['libexample.o'])
	c_build_program('raise_example', ['main.c'], ['libexample.so'])

	cpfile('raise_example', '/usr/bin/raise_example')
	cpfile('libexample.so', '/usr/lib/libexample.so')
